-- MySQL Script generated by MySQL Workbench
-- Tue Dec 31 18:03:04 2019
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`user`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`user` (
  `user_id` INT NOT NULL,
  `email` VARCHAR(255) NOT NULL,
  `password` VARCHAR(100) NOT NULL,
  `nickname` VARCHAR(100) NOT NULL,
  `user_name` VARCHAR(100) NOT NULL,
  `birthday` TIMESTAMP NOT NULL,
  `gender` INT NOT NULL,
  `phone_num` VARCHAR(100) NOT NULL,
  `user_type` INT NOT NULL,
  `profile_photo` VARCHAR(255) NOT NULL,
  `user_address` VARCHAR(255) NOT NULL,
  `usercol` VARCHAR(45) CHARACTER SET 'utf8' COLLATE 'utf8_general_ci' NOT NULL,
  PRIMARY KEY (`user_id`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COMMENT = '	';


-- -----------------------------------------------------
-- Table `mydb`.`review`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`review` (
  `cafe_id` INT NOT NULL,
  `user_id` INT NOT NULL,
  `review_id` INT NULL,
  `nickname` VARCHAR(100) NULL,
  `review_regdate` TIMESTAMP NULL,
  `profile_photo` VARCHAR(255) NULL,
  `review_reg_num` INT NULL,
  `review_reg_subnum` INT NULL,
  `review_photo` VARCHAR(255) NULL,
  PRIMARY KEY (`user_id`),
  CONSTRAINT `user_id`
    FOREIGN KEY (`cafe_id`)
    REFERENCES `mydb`.`user` (`user_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `mydb`.`cafe_facilities`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`cafe_facilities` (
  `cafe_id` INT NOT NULL,
  `wifi` INT NULL,
  `table` INT NULL,
  `interior` INT NULL,
  `music` INT NULL,
  `shopsize` INT NULL,
  `plug` INT NULL,
  `restroom` INT NULL,
  `terrace` INT NULL,
  `studyroom` INT NULL,
  `smoking` INT NULL,
  `wifi_text` TEXT NULL,
  `table_text` TEXT NULL,
  `interior_text` TEXT NULL,
  `music_text` TEXT NULL,
  `shopsize_text` TEXT NULL,
  `plug_text` TEXT NULL,
  `restroom_text` TEXT NULL,
  `studyroom_text` TEXT NULL,
  `parking_text` TEXT NULL,
  `smoking_text` TEXT NULL,
  `terrace_text` TEXT NULL,
  PRIMARY KEY (`cafe_id`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `mydb`.`cafe_basic`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`cafe_basic` (
  `cafe_id` INT NOT NULL,
  `manager_id` INT NULL,
  `cafe_name` VARCHAR(100) NULL,
  `branch` VARCHAR(100) NULL,
  `tel` VARCHAR(100) NULL,
  `time_day` INT NULL,
  `time_start` INT NULL,
  `time_end` INT NULL,
  `rate_avg` INT NULL,
  `review_num` INT NULL,
  PRIMARY KEY (`cafe_id`),
  CONSTRAINT `cafe_id`
    FOREIGN KEY (`cafe_id`)
    REFERENCES `mydb`.`cafe_facilities` (`cafe_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `mydb`.`cafe_address`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`cafe_address` (
  `cafe_id` INT NOT NULL,
  `cafe_address` VARCHAR(255) NULL,
  `sido_name` VARCHAR(100) NULL,
  `sido_code` INT NULL,
  `sigungu_name` VARCHAR(100) NULL,
  `sigungu_code` INT NULL,
  `dong_name` VARCHAR(100) NULL,
  `dong_code` INT NULL,
  `latitude` FLOAT NULL,
  `longitude` FLOAT NULL,
  PRIMARY KEY (`cafe_id`),
  CONSTRAINT `cafe_id`
    FOREIGN KEY (`cafe_id`)
    REFERENCES `mydb`.`cafe_basic` (`cafe_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `mydb`.`cafe_rate_total`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`cafe_rate_total` (
  `cafe_id` INT NOT NULL,
  `rate_num` INT NULL,
  `taste_sum` INT NULL,
  `facimood_sum` INT NULL,
  `service_sum` INT NULL,
  `wifiplug_sum` INT NULL,
  `clean_sum` INT NULL,
  `price_sum` INT NULL,
  `taste_avg` INT NULL,
  `facimood_avg` INT NULL,
  `service_avg` INT NULL,
  `wifiplug_avg` INT NULL,
  `clean_avg` INT NULL,
  `price_avg` INT NULL,
  `cafe_total_avg` INT NULL,
  PRIMARY KEY (`cafe_id`),
  CONSTRAINT `cafe_id`
    FOREIGN KEY (`cafe_id`)
    REFERENCES `mydb`.`cafe_basic` (`cafe_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `mydb`.`cafe_rate_each`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`cafe_rate_each` (
  `cafe_id` INT NOT NULL,
  `user_id` INT NOT NULL,
  `taste` INT NULL,
  `facimood` INT NULL,
  `service` INT NULL,
  `wifiplug` INT NULL,
  `clean` INT NULL,
  `price` INT NULL,
  `cafe_rate_total_cafe_id` INT NOT NULL,
  PRIMARY KEY (`cafe_id`),
  INDEX `user_id_idx` (`user_id` ASC) VISIBLE,
  CONSTRAINT `cafe_id`
    FOREIGN KEY (`cafe_id`)
    REFERENCES `mydb`.`cafe_rate_total` (`cafe_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `user_id`
    FOREIGN KEY (`user_id`)
    REFERENCES `mydb`.`user` (`user_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `mydb`.`cafe_menu`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`cafe_menu` (
  `cafe_id` INT NOT NULL,
  `menu_id` INT NULL,
  `manu_name` VARCHAR(100) NULL,
  `menu_price` INT NULL,
  `menu_photo` VARCHAR(255) NULL,
  `menu_type` INT NULL,
  PRIMARY KEY (`cafe_id`),
  CONSTRAINT `cafe_id`
    FOREIGN KEY (`cafe_id`)
    REFERENCES `mydb`.`cafe_basic` (`cafe_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `mydb`.`cafe_service`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`cafe_service` (
  `cafe_id` INT NOT NULL,
  `event` INT NULL,
  `coupon` INT NULL,
  `mileage` INT NULL,
  `blanket` INT NULL,
  `drinkrefill` INT NULL,
  PRIMARY KEY (`cafe_id`),
  CONSTRAINT `cafe_id`
    FOREIGN KEY (`cafe_id`)
    REFERENCES `mydb`.`cafe_basic` (`cafe_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `mydb`.`cafe_product`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`cafe_product` (
  `cafe_id` INT NOT NULL,
  `product_id` INT NULL,
  `product_name` VARCHAR(100) NULL,
  `product_price` INT NULL,
  `product_photo` VARCHAR(255) NULL,
  `product_type` INT NULL,
  PRIMARY KEY (`cafe_id`),
  CONSTRAINT `cafe_id`
    FOREIGN KEY (`cafe_id`)
    REFERENCES `mydb`.`cafe_basic` (`cafe_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `mydb`.`board`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`board` (
  `user_id` INT NOT NULL,
  `post_id` INT NOT NULL,
  `board_type` INT NULL,
  `title` TEXT NULL,
  `contents` TEXT NULL,
  `board_regdate` TIMESTAMP NULL,
  PRIMARY KEY (`post_id`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `mydb`.`board_review`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`board_review` (
  `board_review_id` INT NOT NULL,
  `post_id` INT NULL,
  `user_id` INT NULL,
  `board_type` INT NULL,
  `nickname` VARCHAR(100) NULL,
  `review_regdate` TIMESTAMP NULL,
  `profile_photo` VARCHAR(255) NULL,
  `review_reg_num` INT NULL,
  `review_reg_subnum` INT NULL,
  `review_photo` VARCHAR(255) NULL,
  PRIMARY KEY (`board_review_id`),
  INDEX `fk_board_review_board1_idx` (`post_id` ASC) VISIBLE,
  INDEX `fk_board_review_user1_idx` (`user_id` ASC) VISIBLE,
  CONSTRAINT `post_id`
    FOREIGN KEY (`post_id`)
    REFERENCES `mydb`.`board` (`post_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `user_id`
    FOREIGN KEY (`user_id`)
    REFERENCES `mydb`.`user` (`user_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


-- -----------------------------------------------------
-- Table `mydb`.`address_code`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`address_code` (
  `sido_name` VARCHAR(100) NULL,
  `sido_code` INT NULL,
  `sigungu_name` VARCHAR(100) NULL,
  `sigungu_code` INT NULL,
  `dong_name` VARCHAR(100) NULL,
  `dong_code` INT NULL)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
